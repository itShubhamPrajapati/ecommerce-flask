{% extends "base.html" %}

{% block title %}Manage Orders - Modern Shop{% endblock %}

{% block content %}
<div class="container" style="margin-top: 100px; margin-bottom: 50px;">
    <h1 style="margin-bottom: 30px; color: #1f2937;">Manage Orders</h1>
    
    {% if orders %}
    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <thead>
                <tr style="background: #f9fafb;">
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Order ID</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Customer</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Date</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Amount</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Payment ID</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Status</th>
                    <th style="padding: 15px; text-align: left; font-weight: 600; color: #4b5563;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                <tr style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 15px;">
                        <div style="font-weight: 600; color: #1f2937;">{{ order.order_id }}</div>
                    </td>
                    <td style="padding: 15px;">
                        <div style="font-weight: 500; margin-bottom: 5px;">{{ order.user_email }}</div>
                        <div style="font-size: 14px; color: #6b7280;">User ID: {{ order.user_id }}</div>
                    </td>
                    <td style="padding: 15px;">{{ order.created_at.strftime('%Y-%m-%d') }}</td>
                    <td style="padding: 15px;">
                        <div style="font-weight: bold; color: #3b82f6;">â‚¹{{ order.total }}</div>
                    </td>
                    <td style="padding: 15px;">
                        {% if order.payment_id %}
                        <div style="font-size: 14px; color: #6b7280; max-width: 150px; overflow: hidden; text-overflow: ellipsis;">
                            {{ order.payment_id }}
                        </div>
                        {% else %}
                        <span style="color: #6b7280; font-size: 14px;">No payment ID</span>
                        {% endif %}
                    </td>
                    <td style="padding: 15px;">
                        <select onchange="updateOrderStatus('{{ order.order_id }}', this.value)" 
                                style="padding: 8px 12px; border: 2px solid #e5e7eb; border-radius: 6px; background: white; color: #1f2937; font-weight: 500;">
                            <option value="Pending" {% if order.status == 'Pending' %}selected{% endif %}>Pending</option>
                            <option value="Paid" {% if order.status == 'Paid' %}selected{% endif %}>Paid</option>
                            <option value="Shipped" {% if order.status == 'Shipped' %}selected{% endif %}>Shipped</option>
                            <option value="Delivered" {% if order.status == 'Delivered' %}selected{% endif %}>Delivered</option>
                            <option value="Cancelled" {% if order.status == 'Cancelled' %}selected{% endif %}>Cancelled</option>
                        </select>
                    </td>
                    <td style="padding: 15px;">
                        <div style="display: flex; gap: 10px;">
                            <a href="/order/{{ order.order_id }}" class="btn btn-sm btn-outline">
                                <i class="fas fa-eye"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 60px 20px; background: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <i class="fas fa-shopping-cart" style="font-size: 80px; color: #d1d5db; margin-bottom: 20px;"></i>
        <h2 style="margin-bottom: 15px; color: #4b5563;">No orders found</h2>
        <p style="color: #6b7280;">Orders will appear here when customers make purchases.</p>
    </div>
    {% endif %}
</div>

<script>
function updateOrderStatus(orderId, status) {
    if (confirm('Update order status to ' + status + '?')) {
        // In a real app: fetch('/admin/update-order-status', { method: 'POST', body: JSON.stringify({ orderId, status }) })
        alert('Order status would be updated to: ' + status);
    }
}
</script>
{% endblock %}